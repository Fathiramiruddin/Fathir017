<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Biodata Mahasiswa</title>
    <style>
        /* CSS Dasar dan Sederhana */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        h2 {
            text-align: center;
            color: #333;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-simpan { background-color: #28a745; color: white; }
        .btn-edit { background-color: #ffc107; color: black; padding: 5px 10px; margin-right: 5px; }
        .btn-hapus { background-color: #dc3545; color: white; padding: 5px 10px; }
        .btn-batal { background-color: #6c757d; color: white; padding: 10px 15px; }
        .btn-batal-kecil { background-color: #6c757d; color: white; padding: 5px 10px; margin-left: 5px; }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #007bff;
            color: white;
        }

        /* CSS untuk Modal Konfirmasi (Popup Buatan) */
        .modal {
            display: none; /* Sembunyikan modal secara default */
            position: fixed;
            z-index: 10;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5); /* Efek gelap transparan di belakang */
        }
        .modal-content {
            background-color: #fff;
            margin: 15% auto; /* Jarak dari atas dan di tengah */
            padding: 20px;
            border-radius: 8px;
            width: 300px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Sistem Informasi Biodata Mahasiswa</h2>
        
        <!-- Form Input Data -->
        <form id="formMahasiswa" onsubmit="simpanData(event)">
            <div class="form-group">
                <label>NIM:</label>
                <input type="text" id="nim" required placeholder="Masukkan NIM">
            </div>
            <div class="form-group">
                <label>Nama Lengkap:</label>
                <input type="text" id="nama" required placeholder="Masukkan Nama">
            </div>
            <div class="form-group">
                <label>Program Studi:</label>
                <select id="prodi">
                    <option value="TRPL">Teknologi Rekayasa Perangkat Lunak</option>
                    <option value="TI">Teknik Informatika</option>
                    <option value="SI">Sistem Informasi</option>
                </select>
            </div>
            <div class="form-group">
                <label>Semester:</label>
                <input type="number" id="semester" required min="1" max="14" placeholder="Contoh: 4">
            </div>
            
            <button type="submit" class="btn-simpan" id="btnSimpan">Simpan Data</button>
            <button type="button" onclick="resetForm()" class="btn-batal">Batal</button>
        </form>

        <hr style="margin: 30px 0;">

        <!-- Tabel Tampil Data -->
        <h2>Daftar Mahasiswa</h2>
        <table>
            <thead>
                <tr>
                    <th>NIM</th>
                    <th>Nama</th>
                    <th>Prodi</th>
                    <th>Semester</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody id="tabelBody">
                <!-- Data akan dimunculkan di sini oleh JavaScript -->
            </tbody>
        </table>
    </div>

    <!-- Elemen Modal Konfirmasi Hapus -->
    <div id="modalKonfirmasi" class="modal">
        <div class="modal-content">
            <p style="margin-bottom: 20px; font-weight: bold;">Apakah Anda yakin ingin menghapus data ini?</p>
            <button class="btn-hapus" onclick="prosesHapus()">Ya, Hapus</button>
            <button class="btn-batal-kecil" onclick="tutupModal()">Tidak</button>
        </div>
    </div>

    <!-- Logika JavaScript Sederhana -->
    <script>
        // Array untuk menyimpan data sementara
        let dataMahasiswa = [];
        // Variabel untuk melacak data mana yang sedang diedit (-1 berarti sedang tambah data baru)
        let indexEdit = -1; 
        // Variabel untuk melacak data mana yang akan dihapus saat modal muncul
        let indexHapus = -1;

        // Fungsi untuk merender ulang isi tabel
        function tampilkanTabel() {
            const tbody = document.getElementById('tabelBody');
            tbody.innerHTML = ''; // Kosongkan tabel sebelum diisi ulang

            if (dataMahasiswa.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;">Belum ada data</td></tr>';
                return;
            }

            // Looping array dan buat baris tabel
            for (let i = 0; i < dataMahasiswa.length; i++) {
                let mhs = dataMahasiswa[i];
                let baris = `
                    <tr>
                        <td>${mhs.nim}</td>
                        <td>${mhs.nama}</td>
                        <td>${mhs.prodi}</td>
                        <td>${mhs.semester}</td>
                        <td>
                            <button class="btn-edit" onclick="siapkanEdit(${i})">Edit</button>
                            <button class="btn-hapus" onclick="hapusData(${i})">Hapus</button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += baris;
            }
        }

        // Fungsi untuk menyimpan data (Tambah / Update)
        function simpanData(event) {
            event.preventDefault(); // Mencegah halaman reload saat form di-submit

            // Ambil nilai dari form
            let inputNim = document.getElementById('nim').value;
            let inputNama = document.getElementById('nama').value;
            let inputProdi = document.getElementById('prodi').value;
            let inputSemester = document.getElementById('semester').value;

            // Buat objek data baru
            let mahasiswaBaru = {
                nim: inputNim,
                nama: inputNama,
                prodi: inputProdi,
                semester: inputSemester
            };

            if (indexEdit === -1) {
                // Jika indexEdit -1, berarti kita menambah data baru
                dataMahasiswa.push(mahasiswaBaru);
            } else {
                // Jika tidak, berarti kita menimpa (update) data yang sudah ada
                dataMahasiswa[indexEdit] = mahasiswaBaru;
            }

            // Bersihkan form dan perbarui tabel
            resetForm();
            tampilkanTabel();
        }

        // Fungsi untuk mengambil data ke dalam form saat tombol Edit ditekan
        function siapkanEdit(index) {
            let mhs = dataMahasiswa[index];
            
            document.getElementById('nim').value = mhs.nim;
            document.getElementById('nama').value = mhs.nama;
            document.getElementById('prodi').value = mhs.prodi;
            document.getElementById('semester').value = mhs.semester;

            indexEdit = index; // Tandai bahwa kita sedang mengedit index ini
            document.getElementById('btnSimpan').innerText = "Update Data";
        }

        // ================= BAGIAN HAPUS DATA =================
        
        // 1. Munculkan modal ketika tombol Hapus ditekan
        function hapusData(index) {
            indexHapus = index; // Simpan index data yang ingin dihapus
            document.getElementById('modalKonfirmasi').style.display = 'block'; // Tampilkan modal
        }

        // 2. Eksekusi hapus jika pengguna menekan "Ya, Hapus"
        function prosesHapus() {
            if (indexHapus !== -1) {
                dataMahasiswa.splice(indexHapus, 1); // Hapus 1 elemen pada index tersebut
                tampilkanTabel();
                resetForm(); // Reset form untuk berjaga-jaga jika sedang mengedit data yang dihapus
                tutupModal(); // Sembunyikan modal kembali
            }
        }

        // 3. Sembunyikan modal jika pengguna menekan "Tidak"
        function tutupModal() {
            document.getElementById('modalKonfirmasi').style.display = 'none';
            indexHapus = -1; // Reset index hapus
        }

        // =======================================================

        // Fungsi untuk mengembalikan form ke keadaan kosong
        function resetForm() {
            document.getElementById('formMahasiswa').reset();
            indexEdit = -1; // Kembalikan status ke 'tambah data'
            document.getElementById('btnSimpan').innerText = "Simpan Data";
        }

        // Panggil fungsi tampilkanTabel saat halaman pertama kali dibuka
        tampilkanTabel();

    </script>
</body>
</html>